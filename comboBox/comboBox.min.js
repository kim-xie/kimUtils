(function($){var loadingCss={css:function(path){var path=loadingCss.getParentPath()+path;if(!path||path.length===0){throw new Error('argument "path" is required !')}var head=document.getElementsByTagName("head")[0];var link=document.createElement("link");link.href=path;link.rel="stylesheet";link.type="text/css";head.appendChild(link)},getParentPath:function(){var ParentPath=document.scripts;ParentPath=ParentPath[ParentPath.length-1].src.substring(0,ParentPath[ParentPath.length-1].src.lastIndexOf("/")+1);return ParentPath}};loadingCss.css("skin/comboBox.css");$.fn.comboBox=function(options){return this.each(function(){var opts=$.extend({},$.fn.comboBox.defaults,options);init($(this),opts);initEvent($(this),opts)})};function init($this,opts){var comboBox="<div id='comboboxWrap' class='comboboxWrap'>";if(opts.addIdsObj&&opts.validate){comboBox+="<input id='"+opts.removeIdsObj+"' name='"+opts.removeIdsObj+"' type='hidden' class='vilidateObj removeIds' vilidate='"+opts.validateType+"'/>"}if(opts.removeIdsObj&&opts.validate){comboBox+="<input id='"+opts.addIdsObj+"' name='"+opts.addIdsObj+"' type='hidden' class='vilidateObj addIds' vilidate='"+opts.validateType+"'/>"}if(opts.idObj&&opts.validate){comboBox+="<input id='"+opts.idObj+"' name='"+opts.idObj+"' value='"+opts.idValue+"' type='hidden' class='vilidateObj ids' vilidate='"+opts.validateType+"'/>"}comboBox+="<span class='comboBox'>";if(opts.textValue){comboBox+="<span class='vilidateObj contents ellipsis' vilidate='"+opts.validateType+"'>"+opts.textValue+"</span>"}else{comboBox+="<span class='vilidateObj contents ellipsis' vilidate='"+opts.validateType+"'></span>"}comboBox+="	<span class='icon'>"+"		<i class='fa fa-times selectclear pointer cd'></i>"+"		<i class='fa fa-chevron-down sortDown pointer cd'></i>"+"	</span>"+"</span>";if(opts.listId||opts.listClass){comboBox+="<div id='"+opts.listId+"' class='"+opts.listClass+" none' style='overflow:auto;position:absolute;z-index:1000;'>"}if(opts.listType&&opts.listType=="list"&&opts.listcontents){comboBox+="<ul>";var liDom="";for(var i=0;i<opts.listcontents.length;i++){if(opts.showCheckBox){liDom+="<li><a href='javascript:void(0)' style='display:block;padding:5px;font-size:14px' data-id='"+opts.listids[i]+"'><input type='checkBox' style='display:inline-block;width:16px;height:16px;margin-right:5px;vertical-align:top;'>"+opts.listcontents[i]+"</a></li>"}else{liDom+="<li><a href='javascript:void(0)' style='display:block;padding:5px;font-size:14px' data-id='"+opts.listids[i]+"'>"+opts.listcontents[i]+"</a></li>"}}comboBox+=liDom+"</ul>"}comboBox+="</div></div>";$this.append(comboBox);if(opts.width){$this.find(".comboBox").width(opts.width)}if(opts.height){$this.find(".comboBox").height(opts.height)}if(opts.listWidth){$this.find("."+opts.listClass+"").width(opts.listWidth)}if(opts.listHeight){$this.find("."+opts.listClass+"").height(opts.listHeight)}if(opts.listBackground){$this.find("."+opts.listClass+"").css("background",opts.listBackground)}if(opts.listBorder){$this.find("."+opts.listClass+"").css("border",opts.listBorder)}}function initEvent($this,opts){showClear($this);$this.find(".comboBox").click(function(e){var e=e||window.event||arguments.callee.caller.arguments[0];stopPropagation(e);$(this).parent().find("."+opts.listClass+"").toggle();stopDefault(e)});if(opts.listType&&opts.listType=="tree"&&opts.tree){$("#"+opts.listId+"").tmTree(opts.tree)}$this.find(".selectclear").click(function(e){var e=e||window.event||arguments.callee.caller.arguments[0];stopPropagation(e);$(this).parents("#comboboxWrap").find(".contents").text("");if(opts.listType=="tree"){$(this).parents("#comboboxWrap").find(".trees .search_in").val("");$(this).parents("#comboboxWrap").find(".trees .tm-tree-checkbox").removeClass("tm-tree-checkbox-checked").removeClass("tm-tree-checkbox-focus");$(this).parents("#comboboxWrap").find(".trees .tm-tree-radio").removeClass("tm-tree-radio-checked").removeClass("tm-tree-radio-focus");$(this).parents("#comboboxWrap").find(".trees .tree .toggle").removeClass("first_collapsable").addClass("expandable");$(this).parents("#comboboxWrap").find(".trees .tree .father").next().hide()}else{if(opts.listType=="list"&&opts.showCheckBox){$(this).parents("#comboboxWrap").find("input:checkbox").prop("checked",false)}}$(this).hide()});if(opts.listType=="list"&&opts.listcontents){$this.find("ul li a").click(function(){var aText="";var aId="";if(opts.isMultiSelect){var checkedNameArr=[];var checkedIdArr=[];$(this).find("input:checkbox").trigger("click");$this.find("ul li a input[type='checkbox']:checked").each(function(){checkedNameArr.push($(this).parent().text());checkedIdArr.push($(this).parent().data("id"))});$this.find(".contents").text(checkedNameArr.join(",")).attr("title",checkedNameArr.join(","));$this.find("#"+opts.idObj+"").val(checkedIdArr.join(",")).attr("title",checkedIdArr.join(","))}else{$(this).find("input:checkbox").trigger("click");$(this).parent().siblings().find("input:checkbox").prop("checked",false);aText=$(this).text();
aId=$(this).data("id");$this.find(".contents").text(aText).attr("title",aText);$this.find("#"+opts.idObj+"").val(aId).attr("title",aId)}showClear($this)})}$(document).click(function(){$("."+opts.listClass+"").hide()})}$.fn.comboBox.defaults={width:"100%",height:"30px",validate:true,validateType:"required",addIdsObj:"",removeIdsObj:"",idObj:"",idValue:"",textValue:"--请选择一个值--",listId:"comboBoxList",listClass:"comboBoxList",listWidth:"100%",listHeight:"200px",listBackground:"#fff",listBorder:"1px solid #ddd",listType:"list",listids:["1111","2222","3333"],listcontents:["list下拉框测试1","list下拉框测试2","list下拉框测试3"],showCheckBox:true,isMultiSelect:true,tree:{}};function showClear($this){var val=$this.find(".contents").text().trim();if(isNotEmpty(val)){$this.find(".contents").parent().find(".selectclear").show()}else{$this.find(".contents").parent().find(".selectclear").hide()}}function stopPropagation(e){if(e&&e.stopPropagation){e.stopPropagation()}else{window.event.cancelBubble=true}}function stopDefault(e){if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}return false}function isEmpty(val){val=$.trim(val);if(val==null){return true}if(val==undefined||val=="undefined"){return true}if(val==""){return true}if(val.length==0){return true}if(!/[^(^\s*)|(\s*$)]/.test(val)){return true}return false}function isNotEmpty(val){return !isEmpty(val)}})(jQuery);